apiVersion: v1
kind: Pod
metadata:
  labels:
    app: kafka-cli2
  name: kafka-cli2
spec:
  containers:
    - name: kafka-cli2
      command:
        - /bin/sh
        - '-c'
        - |
          cp /user/app/config/create_cert.sh /tmp/create_cert.sh &&
          chmod +x /tmp/create_cert.sh &&
          /tmp/create_cert.sh &&
          tail -f /dev/null
      image: confluentinc/cp-kafka-connect:7.3.1
      volumeMounts:
        - name: kafka-certs-cluster-ca-cert
          mountPath: /user/app/ca-cert
        - name: config-volume
          mountPath: /user/app/config
      env:
        - name: KAFKA_BOOTSTRAP_SERVERS
          value: kafka-certs-kafka-bootstrap:9093
  volumes:
    - name: kafka-certs-cluster-ca-cert
      secret:
        secretName: kafka-certs-cluster-ca-cert
    - name: config-volume
      configMap:
        name: client-cli2
